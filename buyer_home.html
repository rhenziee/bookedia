<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Bookedia</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='buyerstyles.css') }}">
    <!-- Include SweetAlert CSS and JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>
<body>
    <!-- Header -->
<div class="top_header">
    <img src="..//static/icons/logo.png">
    <div class="search">
        <input type="text" id="search-input" placeholder="Search for books, albums, etc." />
        <img src="{{ url_for('static', filename='icons/search icon.png') }}" id="search-btn" style="cursor: pointer;" />

    </div>

    
    
    <div class="top_header_icons">
        <img src="../static/icons/basket.png" alt="Cart" class="cart-icon" onclick="window.location.href='/cart'" >
        <img src="{{ url_for('static', filename='icons/chat-round-dots-svgrepo-com 5.png') }}" 
             alt="Chat" 
             class="chat-icon" 
             style="width: 35px; height: 35px; cursor: pointer;" 
             onclick="window.location.href='/messages'">
    
           
             <a href="/notifications">
                <img src="../static/icons/Bell.png" alt="Notifications" class="icon">
            </a>
            
        
      
        <div class="dropdown">
            <!-- Profile Picture -->
            <img src="../static/icons/user.png" alt="User" class="usercon-icon" onclick="toggleDropdown()">


    
            <!-- Dropdown Menu -->
            <div id="userDropdown" class="dropdown-content">
                <a href="/pending">Orders</a>
                <a href="/buyersetting">Settings</a>
                <a href="/logout">Logout</a>
            </div>
        </div>
    </div>
    
    
    
    
</div>
</div>


    <!-- Navigation -->
    <nav>
        <ul>
            <li><a onclick="window.location.href='/buyer_home'">Home</a></li>
<!-- books -->
            <li>
                <a onclick="window.location.href='/buyer_books'">Books</a> 
                <ul class="dropdown">
                    <li><a href="#">Fiction</a></li>
                    <li><a href="#">Non-Fiction</a></li>
                </ul>
            </li>

<!-- magazine-->
            <li>
                <a onclick="window.location.href='/buyer_magazines'">Magazines & Periodicals</a>
                <ul class="dropdown">
                    <li><a href="#">Fashion</a></li>
                    <li><a href="#">Technology</a></li>
                    <li><a href="#">Lifestyle</a></li>
                    <li><a href="#">Sports News</a></li>
                </ul>
            </li>
<!-- music-->
            <li>
                <a onclick="window.location.href='/buyer_music'">Music</a> 
                <ul class="dropdown">
                    <li><a href="#">Pop</a></li>
                    <li><a href="#">Rock</a></li>
                    <li><a href="#">Jazz</a></li>
                    <li><a href="#">Classical</a></li>
                    <li><a href="#">Hiphop</a></li>
                </ul>
            </li>
<!-- Movies -->
            <li><a onclick="window.location.href='/buyer_movies'">Movies</a>
                <ul class="dropdown">
                    <li><a href="#">Action</a></li>
                    <li><a href="#">Comedy</a></li>
                    <li><a href="#">Drama</a></li>
                    <li><a href="#">Horror</a></li>
                    <li><a href="#">Sci-fi</a></li>
                </ul>
            </li>
<!-- Gaming -->
            <li><a onclick="window.location.href='/buyer_gaming'">Gaming</a>
                <ul class="dropdown">
                    <li><a href="#">Video Games</a></li>
                    <li><a href="#">Consoles</a></li>
                </ul>
            </li>
<!-- educ -->
            <li><a onclick="window.location.href='/buyer_educ'">Edu DVDs</a>
                <ul class="dropdown">
                    <li><a href="#">History</a></li>
                    <li><a href="#">Science</a></li>
                    <li><a href="#">Math</a></li>
                    <li><a href="#">Language</a></li>
                    <li><a href="#">Arts</a></li>
                </ul>
            </li>
        </ul>
    </nav>
    

<!-- Feauture Section -->
<section class="feature" id="feauture">
    <div class="slider">
        <div class="text">
          
            <div class="loader">
              <p class="text">
            SHOP AND BUY <br>
                WITH CONFIDENCE
              </p>
            </div>
            
        
            <button class="shop_btn" id="shop_btn" >
            SHOP NOW
            <div class="star-1">
                <svg
                xmlns="http://www.w3.org/2000/svg"
                xml:space="preserve"
                version="1.1"
                style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                viewBox="0 0 784.11 815.53"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                >
                <defs></defs>
                <g id="Layer_x0020_1">
                    <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                    <path
                    class="fil0"
                    d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                    ></path>
                </g>
                </svg>
            </div>
            <div class="star-2">
                <svg
                xmlns="http://www.w3.org/2000/svg"
                xml:space="preserve"
                version="1.1"
                style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                viewBox="0 0 784.11 815.53"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                >
                <defs></defs>
                <g id="Layer_x0020_1">
                    <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                    <path
                    class="fil0"
                    d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                    ></path>
                </g>
                </svg>
            </div>
            <div class="star-3">
                <svg
                xmlns="http://www.w3.org/2000/svg"
                xml:space="preserve"
                version="1.1"
                style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                viewBox="0 0 784.11 815.53"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                >
                <defs></defs>
                <g id="Layer_x0020_1">
                    <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                    <path
                    class="fil0"
                    d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                    ></path>
                </g>
                </svg>
            </div>
            <div class="star-4">
                <svg
                xmlns="http://www.w3.org/2000/svg"
                xml:space="preserve"
                version="1.1"
                style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                viewBox="0 0 784.11 815.53"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                >
                <defs></defs>
                <g id="Layer_x0020_1">
                    <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                    <path
                    class="fil0"
                    d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                    ></path>
                </g>
                </svg>
            </div>
            <div class="star-5">
                <svg
                xmlns="http://www.w3.org/2000/svg"
                xml:space="preserve"
                version="1.1"
                style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                viewBox="0 0 784.11 815.53"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                >
                <defs></defs>
                <g id="Layer_x0020_1">
                    <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                    <path
                    class="fil0"
                    d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                    ></path>
                </g>
                </svg>
            </div>
            <div class="star-6">
                <svg
                xmlns="http://www.w3.org/2000/svg"
                xml:space="preserve"
                version="1.1"
                style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                viewBox="0 0 784.11 815.53"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                >
                <defs></defs>
                <g id="Layer_x0020_1">
                    <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                    <path
                    class="fil0"
                    d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                    ></path>
                </g>
                </svg>
            </div>
            </button>

        </div>
    </div>
</section>

<!-- Trending Products -->
<section class="trending" id="trends">
    <h2>Trending Products</h2>
    <div class="trending_container">
        <button class="arrow left-arrow">&lt;</button> <!-- Left Arrow -->
        <div class="products" id="products-container">
            {% for product in trending_products %}
            <div class="product" data-product-id="{{ product.id }}">
                <img src="{{ url_for('uploaded_product_file', filename=product.product_image) }}" alt="{{ product.product_name }}" style="width: 200px; height: 200px;">
                <div class="content">
                    <h3>{{ product.product_name }}</h3>
                    <p>₱ {{ product.product_price }}</p>
                    <p>Stock: {{ product.product_quantity }}</p> 
                    <p class="product-description" style="display: none;">{{ product.product_description }}</p>
                </div>
                <div class="button-container">
                    <button class="toggle-description-button">Show Description</button>
                    <button class="add-to-cart-button" data-product-name="{{ product.product_name }}"
                        data-product-image="{{ url_for('uploaded_product_file', filename=product.product_image) }}"
                        data-product-price="{{ product.product_price }}">Add to Cart</button>
                    
                    <button class="btn-buy-now" data-product-name="{{ product.product_name }}"
                        data-product-image="{{ url_for('uploaded_product_file', filename=product.product_image) }}"
                        data-product-price="{{ product.product_price }}">Buy Now</button>
                    
                    <button class="message-seller-button" 
                        data-product-id="{{ product.id }}" 
                        data-product-name="{{ product.product_name }}" 
                        data-seller-id="{{ product.user_id }}"
                        onclick="openInquireForm('{{ product.id }}', '{{ product.product_name }}', '{{ product.user_id }}')">Message Seller</button>
                </div>
            </div>
            
            {% endfor %}
        </div>



        <button class="arrow right-arrow">&gt;</button> <!-- Right Arrow -->
    </div>
</section>

</body>

<div id="overlay" style="display: none;"></div>

<div class="adding-card" id="addingCardPopup" style="display: none;">
    <div class="adding-image_container" id="adding-image_container">
        <!-- This will be filled with the product image -->
    </div>
    <div class="product-details d-flex align-items-center">
        <div class="adding-title me-3">
            <span id="popupProductName">New brand name</span>
        </div>
        <div class="quantity">
            <label for="quantityInput" class="form-label" >Quantity</label>
            <input type="number" id="quantityInput" class="form-control quantity-input" value="1" min="1" />
        </div>
    </div>
    
    <div class="action">
        <div class="price">
            <span id="popupProductPrice"></span>
        </div>
        <button class="cart-button" id="addToCart">
            <span>Add to cart</span>
        </button>
        <button class="cart-button" onclick="hideAddingCard()">
            <span>CANCEL</span>
        </button>
        
    </div>
</div>


<!-- buy now naman -->
<div class="master-container" id="popupContainer" style="display: none;"> 
    <div class="checkoutcard checkoutcart">
        <label class="checkout-title">BUY NOW</label>
        <div class="checkout-products">
            <div class="checkout-product" id="cartProductContainer">
                <img src="your-image-source.jpg" alt="Product Image" />
                <div>
                    <h3 class="product-name">Product Name</h3>
                    <span class="product-price">₱ 100.00</span>
                    <input type="number" class="quantity-input" value="1" min="1" />
                </div>
            </div>
        </div>
    </div>

    <div class="checkoutcard checkout">
        <label class="checkout-title">Checkout</label>
        <div class="checkout-details">
            <span>Your cart subtotal:</span><span id="cartSubtotal">₱ 0.00</span>
            <span>Shipping fees:</span><span>₱ 50.00</span>
            <span>Total Price:</span><span id="checkoutTotal">₱ 0.00</span>
        </div>
        <div class="checkout--footer">
            <button class="cancel-btn" onclick="window.location.href='/buyer_home'">Cancel</button>
            <button class="checkout-btn" onclick="window.location.href='/place_order'">Checkout</button>
        </div>
    </div>
</div>




<!-- Discover Section -->
<section class="discover-section" id="discover_section">
    <div class="spinner">
        <span>D</span>
        <span>I</span>
        <span>S</span>
        <span>C</span>
        <span>O</span>
        <span>V</span>
        <span>E</span>
        <span>R</span>
    </div>
    <div class="discoverproduct-grid">
        {% for product in products %}
        <div class="discoverproduct-box" data-product-id="{{ product.id }}">
            <img src="{{ url_for('uploaded_product_file', filename=product.product_image) }}" alt="{{ product.product_name }}" style="width: 200px; height: 200px;">
            <div class="discoverproduct-info">
                <h3>{{ product.product_name }}</h3>
                        <!-- Display the rating -->
                        <p class="rating">
                            {% set stars = product.average_rating|round(0, 'floor')|int %}
                            {% for i in range(stars) %}
                                <span>⭐</span>
                            {% endfor %}
                            {% if product.average_rating - stars > 0 %}
                                <span>⭐</span> <!-- Partial star (if any decimal part) -->
                            {% endif %}
                            {% for i in range(5 - stars - (1 if product.average_rating - stars > 0 else 0)) %}
                                <span>☆</span> <!-- Empty stars to fill up to 5 -->
                            {% endfor %}
                            <span> {{ product.average_rating|round(2) }}</span> <!-- Display rating count (e.g., 4.9) -->
                        </p>
                <p class="price">₱ {{ product.product_price }}</p>
                <p>Stock: {{ product.product_quantity }}</p>
                <p class="product-description" style="display: none;">{{ product.product_description }}</p>
                <button class="btn-show-description">Show Description</button>
                <div class="actions">
                    <!-- First row: Add to Cart and Buy Now buttons -->
                    <button class="add-to-cart-button" data-product-name="{{ product.product_name }}"
                        data-product-image="{{ url_for('uploaded_product_file', filename=product.product_image) }}"
                        data-product-price="{{ product.product_price }}">Add To Cart</button>

                    <button class="btn-buy-now" data-product-name="{{ product.product_name }}"
                        data-product-image="{{ url_for('uploaded_product_file', filename=product.product_image) }}"
                        data-product-price="{{ product.product_price }}">Buy Now</button>

                    <button class="message-seller-button" 
                        data-product-id="{{ product.id }}" 
                        data-product-name="{{ product.product_name }}" 
                        data-seller-id="{{ product.seller_id }}"
                        onclick="openInquireForm('{{ product.id }}', '{{ product.product_name }}', '{{ product.seller_id }}')">Message Seller</button>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</section>



<!-- Scroll to Top Button -->
<button id="scrollToTopBtn" title="Go to top">↑</button>



    <script>

// para sa shop now
document.getElementById('shop_btn').addEventListener('click', function() {
    const targetSection = document.getElementById('discover_section');
    const navbarHeight = document.querySelector('nav').offsetHeight;


    const extraPadding = 80; 


    const sectionPosition = targetSection.getBoundingClientRect().top + window.pageYOffset - navbarHeight - extraPadding;


    window.scrollTo({
        top: sectionPosition,
        behavior: 'smooth'
    });
});

// search

document.getElementById("search-btn").addEventListener("click", function() {
    const query = document.getElementById("search-input").value;
    if (query) {
        console.log("Search triggered with query:", query);  // Debugging
        window.location.href = `/search?query=${encodeURIComponent(query)}`;
    }
});

// Handle "Enter" key press
document.getElementById("search-input").addEventListener("keydown", function(e) {
    if (e.key === "Enter") {
        const query = document.getElementById("search-input").value;
        if (query) {
            console.log("Search triggered with query (Enter):", query);  // Debugging
            window.location.href = `/search?query=${encodeURIComponent(query)}`;
        }
    }
});



// Get the button
const scrollToTopBtn = document.getElementById("scrollToTopBtn");

// Show the button when the user scrolls down 200px from the top
window.onscroll = function() {
  if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
    scrollToTopBtn.style.display = "block";  // Show button
  } else {
    scrollToTopBtn.style.display = "none";   // Hide button
  }
};

// Scroll to the top when the button is clicked
scrollToTopBtn.onclick = function() {
  window.scrollTo({
    top: 0,
    behavior: 'smooth'  // Smooth scroll
  });
};
        // Toggle dropdown visibility
function toggleDropdown() {
  const dropdown = document.getElementById('userDropdown');
  dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
}

// Close dropdown when clicking outside
window.onclick = function (event) {
  if (!event.target.matches('.usercon-icon')) {
    const dropdown = document.getElementById('userDropdown');
    if (dropdown.style.display === 'block') {
      dropdown.style.display = 'none';
    }
  }
};

        document.addEventListener('DOMContentLoaded', function() {
    const leftArrow = document.querySelector('.left-arrow');
    const rightArrow = document.querySelector('.right-arrow');
    const productContainer = document.querySelector('.products');

    // Define how far the products scroll when clicking the arrows
    const scrollAmount = 400; // Adjust as needed

    // Scroll left when clicking the left arrow
    leftArrow.addEventListener('click', () => {
        productContainer.scrollBy({
            left: -scrollAmount,
            behavior: 'smooth'
        });
    });

    // Scroll right when clicking the right arrow
    rightArrow.addEventListener('click', () => {
        productContainer.scrollBy({
            left: scrollAmount,
            behavior: 'smooth'
        });
    });
});
// para sa trending lang




// para lumabas and descript
document.addEventListener('DOMContentLoaded', function() {
    const products = document.querySelectorAll('.product'); // Select all product boxes

    products.forEach(product => {
        const toggleButton = product.querySelector('.toggle-description-button'); // Select the toggle button
        const description = product.querySelector('.product-description'); // Select the product description

        toggleButton.addEventListener('click', function(event) {
            // Prevent event propagation to other elements
            event.stopPropagation(); 

            // Toggle the display of the clicked product's description
            if (description.style.display === 'none' || description.style.display === '') {
                description.style.display = 'block'; // Show description
                toggleButton.textContent = 'Hide Description'; // Change button text
            } else {
                description.style.display = 'none'; // Hide description
                toggleButton.textContent = 'Show Description'; // Change button text back
            }
        });
    });
});

// For the discover products section
document.addEventListener('DOMContentLoaded', function() {
    const discoverProducts = document.querySelectorAll('.discoverproduct-box'); // Select all product boxes in Discover Section

    discoverProducts.forEach(product => {
        const toggleButton = product.querySelector('.btn-show-description'); // Select the toggle button
        const description = product.querySelector('.product-description'); // Select the product description

        toggleButton.addEventListener('click', function(event) {
            // Prevent event propagation to other elements
            event.stopPropagation(); 

            // Toggle the display of the clicked product's description
            if (description.style.display === 'none' || description.style.display === '') {
                description.style.display = 'block'; // Show description
                toggleButton.textContent = 'Hide Description'; // Change button text
            } else {
                description.style.display = 'none'; // Hide description
                toggleButton.textContent = 'Show Description'; // Change button text back
            }
        });
    });
});






function showAddingCard() {
    document.getElementById('addingCardPopup').style.display = 'flex'; // Show the modal
    document.getElementById('overlay').style.display = 'block'; // Show overlay
}

// Function to hide the modal
function hideAddingCard() {
    document.getElementById('addingCardPopup').style.display = 'none';
    document.getElementById('overlay').style.display = 'none'; // Hide overlay
}

// Close modal when clicking outside of it
document.getElementById('overlay').addEventListener('click', function(event) {
    // Check if the click is on the overlay, not on the modal itself
    const modal = document.getElementById('addingCardPopup');
    if (event.target === this) {
        hideAddingCard();
    }
});



document.addEventListener('DOMContentLoaded', function() {
    // Get all the Add to Cart buttons
    document.querySelectorAll('.add-to-cart-button').forEach(button => {
        button.addEventListener('click', function() {
            // Get the product data from the button attributes
            const productName = this.getAttribute('data-product-name');
            const productImage = this.getAttribute('data-product-image');
            const productPrice = this.getAttribute('data-product-price');

            // Update the modal with the product details
            document.getElementById('popupProductName').textContent = productName;

            // Clear previous image and set new image
            const imageContainer = document.getElementById('adding-image_container');
            imageContainer.innerHTML = ''; // Clear previous image
            const imgTag = document.createElement('img');
            imgTag.src = productImage;
            imgTag.alt = productName;
            imgTag.style.width = '100%'; // Adjust as necessary
            imageContainer.appendChild(imgTag); // Append the new image

            document.getElementById('popupProductPrice').textContent = `₱ ${productPrice}`;
            
            // Reset quantity field to 1
            document.getElementById('quantityInput').value = 1;

            // Display the modal
            document.getElementById('addingCardPopup').style.display = 'block';
        });
    });

    // Logic to add the item to the cart
    document.getElementById('addToCart').addEventListener('click', function(event) {
    event.preventDefault();

    const productName = document.getElementById('popupProductName').innerText;
    const quantity = parseInt(document.getElementById('quantityInput').value);
    const priceText = document.getElementById('popupProductPrice').innerText;

    const price = parseFloat(priceText.replace('₱', '').trim());
    const productImage = document.querySelector('#adding-image_container img').src;
    const imageFilename = productImage.substring(productImage.lastIndexOf('/') + 1);

    if (!productName || quantity <= 0 || isNaN(price)) {
        alert('Please fill in all required fields correctly.');
        return;
    }

    const cartData = {
        product_name: productName,
        quantity: quantity,
        price: price,
        product_image: imageFilename
    };

    // Make a POST request to add to cart
    fetch('/add_to_cart', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(cartData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            Swal.fire({
                icon: 'success',
                title: 'Success!',
                text: 'Product added to cart successfully!',
                confirmButtonText: 'OK'
            });
            document.getElementById('quantityInput').value = 1;
            hideAddingCard();
        } else if (data.error === 'Requested quantity exceeds available stock.') {
            Swal.fire({
                icon: 'error',
                title: 'Error!',
                text: 'Requested quantity exceeds available stock.',
                confirmButtonText: 'OK'
            });
        } else {
            Swal.fire({
                icon: 'error',
                title: 'Error!',
                text: data.error,
                confirmButtonText: 'OK'
            });
        }
    })
    .catch(error => {
        console.error('Error:', error);
        Swal.fire({
            icon: 'error',
            title: 'Error!',
            text: 'An error occurred while adding to cart.',
            confirmButtonText: 'OK'
        });
    });
});

});

// BUY NOW
document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.btn-buy-now').forEach(button => {
        button.addEventListener('click', function () {
            const productName = this.getAttribute('data-product-name');
            const productImage = this.getAttribute('data-product-image');
            const productPrice = parseFloat(this.getAttribute('data-product-price'));

            const cartProductContainer = document.getElementById('cartProductContainer');
            cartProductContainer.innerHTML = '';

            const productDiv = document.createElement('div');
            productDiv.classList.add('checkout-product');
            productDiv.innerHTML = `
                <img src="${productImage}" alt="${productName}" style="width: 100px; height: auto;" />
                <div>
                    <span>${productName}</span><br>
                    <label class="price small">₱ ${productPrice.toFixed(2)}</label>
                </div>
                <input type="number" min="1" value="1" class="quantity-input" />
            `;
            cartProductContainer.appendChild(productDiv);

            const quantityInput = productDiv.querySelector('.quantity-input');
            quantityInput.addEventListener('input', function () {
                const newTotal = productPrice * parseInt(quantityInput.value);
                updateSubtotal(newTotal);
            });

            // Set initial subtotal and show master container
            updateSubtotal(productPrice);
            document.querySelector('.master-container').style.display = 'block';
        });
    });

    function updateSubtotal(price) {
        const shippingFee = 50.00;
        const total = price + shippingFee;
        document.getElementById('cartSubtotal').textContent = `₱ ${price.toFixed(2)}`;
        document.getElementById('checkoutTotal').textContent = `₱ ${total.toFixed(2)}`;
    }
function closePopup() {
    document.getElementById('popupContainer').style.display = 'none';
  }

});
document.querySelector('.checkout-btn').addEventListener('click', function () {
    const productName = document.querySelector('.checkout-product span')?.textContent;
    const quantity = parseInt(document.querySelector('.quantity-input')?.value);
    const subtotalText = document.getElementById('cartSubtotal')?.textContent;

    if (!productName || !subtotalText || isNaN(quantity) || quantity <= 0) {
        Swal.fire({
            icon: 'error',
            title: 'Error!',
            text: 'Please ensure all fields are filled out correctly.',
            confirmButtonText: 'OK'
        });
        return;
    }

    const subtotal = parseFloat(subtotalText.replace('₱ ', ''));
    const shippingFee = 50.00;
    const totalPrice = subtotal + shippingFee;

    // Store data in sessionStorage
    sessionStorage.setItem('orderData', JSON.stringify({
        productName,
        quantity,
        subtotal,
        shippingFee,
        totalPrice
    }));

    // Redirect to the place order page
    window.location.href = '/place_order';
});







// para di maka checkout pag wala
document.getElementById('checkout-btn').addEventListener('click', () => {
    const selectedItems = [...document.querySelectorAll('.item-checkbox:checked')].map(cb => cb.dataset.itemId);
    if (selectedItems.length === 0) {
        alert('Please select at least one item to checkout.');
        return;
    }
    
    // Create a query string with selected items
    const queryString = selectedItems.map(id => `itemId=${id}`).join('&');

    // Redirect to the place_order.html page with selected items
    window.location.href = `/place_order?${queryString}`;
});



// message

    document.querySelectorAll('.message-seller-button').forEach(button => {
        button.addEventListener('click', function() {
            const productId = this.getAttribute('data-product-id');
            const sellerId = this.getAttribute('data-seller-id');
            
            console.log(`Redirecting to inquire page with product ID: ${productId}, seller ID: ${sellerId}`); // Add this for debugging

            // Redirect to inquire.html with query parameters
            window.location.href = `/inquire?product_id=${productId}&seller_id=${sellerId}`;
        });
    });

    function openInquireForm(productId, productName, sellerId) {
        // Redirect to the inquire page with query parameters
        window.location.href = `/inquire.html?product_id=${productId}&product_name=${encodeURIComponent(productName)}&seller_id=${sellerId}`;
    }
    document.addEventListener('DOMContentLoaded', function () {
            // Check for flashed messages
            const successMessage = "{{ get_flashed_messages(with_categories=True) | tojson | safe }}";
            const errorMessage = "{{ get_flashed_messages(with_categories=True) | tojson | safe }}";

            // If there are messages, show them
            if (successMessage) {
                successMessage.forEach(function (msg) {
                    Swal.fire({
                        title: msg[0] === 'success' ? 'Success!' : 'Error!',
                        text: msg[1],
                        icon: msg[0] === 'success' ? 'success' : 'error',
                        confirmButtonText: 'OK'
                    });
                });
            }
        });




// view message




    </script>
    
</body>
</html>
